(()=>{"use strict";function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}const t=function(){function t(e){var n=e.baseUrl,o=e.headers;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._baseUrl=n,this._authorize=o.authorization,this._contentType=o["Content-Type"]}var n,o;return n=t,(o=[{key:"getInitialCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{method:"GET",headers:{authorization:this._authorize}}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"getUserInfo",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{method:"GET",headers:{authorization:this._authorize}}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"editProfile",value:function(e){return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:{authorization:this._authorize,"Content-Type":this._contentType},body:JSON.stringify({name:e.name,about:e.about})}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"editAvatar",value:function(e){var t=e.link;return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:{authorization:this._authorize,"Content-Type":this._contentType},body:JSON.stringify({avatar:t})}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"addCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:{authorization:this._authorize,"Content-Type":this._contentType},body:JSON.stringify({name:e.name,link:e.link})}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"addLike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:{authorization:this._authorize}}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"removeLike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:{authorization:this._authorize}}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"deleteCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:{authorization:this._authorize,"Content-Type":this._contentType}}).then((function(e){return e.ok?e:Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}}])&&e(n.prototype,o),t}();var n={formSelector:".form",inputSelector:".popup__input",submitButton:".popup__save-button",inactiveButtonClass:"popup__save-button_disabled",inputErrorClass:"popup__input-error",inputBorderError:"popup__input-error_color"},o=document.querySelector(".popup__close-button_images"),r=document.querySelector(".popup__form-places"),i=(document.querySelector(".popup"),document.querySelector(".popup__input_text_name")),a=document.querySelector(".popup__input_text_title"),c=document.querySelector(".popup__close-button_places"),u=document.querySelector(".profile__add"),s=document.querySelector(".profile__edit"),l=(document.querySelector(".profile__name"),document.querySelector(".profile__title"),document.querySelector(".popup__close-button_profile")),f=document.querySelector(".profile__img-edit"),p=document.querySelector(".popup__close-button_avatar");function h(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}document.querySelector(".places__heart-button");const d=function(){function e(t){var n=t.data,o=t.handleCardClick,r=t.template,i=t.isMine,a=t.myId,c=t.handleDeleteCard,u=t.handleCardLikes;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._template=r,this._element=this._getTemplate(),this._data=n,this._name=n.name,this._link=n.link,this._alt=n.name,this._likes=n.likes,this._handleCardClick=o,this._isMine=i,this._myId=a,this._handleDeleteCard=c,this.handleCardLikes=u,this._heartButton=this._element.querySelector(".places__heart-button"),this._heartCount=this._element.querySelector(".places__heart-count")}var t,n;return t=e,(n=[{key:"_getTemplate",value:function(){return document.querySelector(this._template).content.cloneNode(!0)}},{key:"_setEventListeners",value:function(){var e=this;this.placeImage.addEventListener("click",(function(){e._handleCardClick(e._name,e._link)})),this._trashButton.addEventListener("click",(function(){e._handleDeleteCard()})),this._heartButton.addEventListener("click",(function(){e.handleCardLikes()}))}},{key:"isLiked",value:function(){return!!this._heartButton.classList.contains("places__heart-button_active")}},{key:"addLike",value:function(){this._heartButton.classList.add("places__heart-button_active")}},{key:"removeLike",value:function(){this._heartButton.classList.remove("places__heart-button_active")}},{key:"updateLikes",value:function(e){this._heartCount.textContent=e.length}},{key:"_showLikes",value:function(){var e=this;this._likes.forEach((function(t){t._id===e._myId()&&e._heartButton.classList.add("places__heart-button_active")}))}},{key:"_removeDeleteButton",value:function(){this._trashButton.style.display="none"}},{key:"generateCard",value:function(){var e=this._element.querySelector(".places__img"),t=this._element.querySelector(".places__name");return this._trashButton=this._element.querySelector(".places__delete-button"),this.placeImage=e,this.placeName=t,this.placeImage.src=this._link,this.placeName.textContent=this._name,this.placeImage.alt=this.placeName.textContent,this._isMine()||this._removeDeleteButton(),this._showLikes(),this._heartCount.textContent=this._data.likes.length,this._setEventListeners(),this._element.firstElementChild}}])&&h(t.prototype,n),e}();function _(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}const y=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.settingsObj=t,this._inputSelector=t.inputSelector,this._submitButton=t.submitButton,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._inputBorderError=t.inputBorderError,this.formElement=n}var t,n;return t=e,(n=[{key:"_showInputError",value:function(e,t){var n=this.formElement.querySelector("#".concat(e.id,"-error"));e.classList.add(this._inputBorderError),n.textContent=t}},{key:"_hideInputError",value:function(e){var t=this.formElement.querySelector("#".concat(e.id,"-error"));e.classList.remove(this._inputBorderError),t.textContent=""}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"_hasInvalidInput",value:function(e){return e.some((function(e){return!e.validity.valid}))}},{key:"_toggleButtonState",value:function(e,t){this._hasInvalidInput(e)?(t.classList.add(this._inactiveButtonClass),t.disabled=!0):(t.classList.remove(this._inactiveButtonClass),t.disabled=!1)}},{key:"_setEventListeners",value:function(){var e=this,t=Array.from(this.formElement.querySelectorAll(this._inputSelector)),n=this.formElement.querySelector(this._submitButton);this._toggleButtonState(t,n),t.forEach((function(o){o.addEventListener("input",(function(){e._checkInputValidity(o),e._toggleButtonState(t,n)}))})),this.formElement.addEventListener("reset",(function(){t.forEach((function(o){e._hideInputError(o),e._toggleButtonState(t,n)}))}))}},{key:"enableValidation",value:function(e){this.formElement.addEventListener("submit",(function(e){e.preventDefault()})),this._setEventListeners()}}])&&_(t.prototype,n),e}();function v(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}const m=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popup=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this),this.handleCloseOverlay=this.handleCloseOverlay.bind(this)}var t,n;return t=e,(n=[{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this.close()}},{key:"handleCloseOverlay",value:function(e){e.target.classList.contains("popup_open")&&this.close()}},{key:"open",value:function(){this._popup.classList.add("popup_open"),document.addEventListener("keydown",this._handleEscClose),this._popup.addEventListener("click",this.handleCloseOverlay)}},{key:"close",value:function(){this._popup.classList.remove("popup_open"),document.removeEventListener("keydown",this._handleEscClose),this._popup.removeEventListener("click",this.handleCloseOverlay)}},{key:"setEventListeners",value:function(){var e=this;this._popup.querySelector(".popup__close-button").addEventListener("click",(function(){e.close()}))}}])&&v(t.prototype,n),e}();function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function g(e,t,n){return(g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=C(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S(e,t){return!t||"object"!==b(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}const L=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(a,e);var t,n,o,r,i=(o=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=C(o);if(r){var n=C(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return S(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e))._submitHandler=t,n._form=n._popup.querySelector(".form"),n._saveButton=n._popup.querySelector(".popup__save-button"),n}return t=a,(n=[{key:"_getInputValues",value:function(){var e=this._form.querySelectorAll(".popup__input"),t={};return e.forEach((function(e){t[e.name]=e.value})),t}},{key:"close",value:function(){g(C(a.prototype),"close",this).call(this),this._form.reset()}},{key:"isLoading",value:function(e){e?(this._saveButton.textContent="Saving...",console.log(this._saveButton.textContent)):(this._saveButton.textContent="",console.log(this._saveButton.textContent))}},{key:"setEventListeners",value:function(){var e=this;g(C(a.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",(function(t){e.isLoading(!0),console.log("loading");var n=e._getInputValues();e._submitHandler(n),t.preventDefault(),e.close(),e.isLoading(!1),console.log("loaded")}))}}])&&k(t.prototype,n),a}(m);function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function j(e,t,n){return(j="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=q(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function I(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function q(e){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}const T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}(a,e);var t,n,o,r,i=(o=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=q(o);if(r){var n=q(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return I(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e))._popupPhoto=t._popup.querySelector(".popup__image"),t._popupTitle=t._popup.querySelector(".popup__image-title"),t}return t=a,(n=[{key:"open",value:function(e,t){j(q(a.prototype),"open",this).call(this),this._popupPhoto.src=t,this._popupTitle.textContent=e}}])&&O(t.prototype,n),a}(m);function B(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}const R=function(){function e(t,n){var o=t.items,r=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._items=o,this._renderer=r,this._cardElement=document.querySelector(n)}var t,n;return t=e,(n=[{key:"renderItems",value:function(e){var t=this;e.forEach((function(e){t._renderer(e)}))}},{key:"addItem",value:function(e){this._cardElement.prepend(e)}}])&&B(t.prototype,n),e}();function x(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}const D=function(){function e(t){var n=t.nameSelector,o=t.jobSelector,r=t.avatarSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=document.querySelector(n),this._job=document.querySelector(o),this._avatar=document.querySelector(r)}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return{name:this._name.textContent,job:this._job.textContent,myId:this.myId}}},{key:"setUserInfo",value:function(e){this._name.textContent=e.name,this._job.textContent=e.about,this.myId=e._id}},{key:"changeAvatar",value:function(e){this._avatar.style.backgroundImage="url(".concat(e.avatar,")")}}])&&x(t.prototype,n),e}();function U(e){return(U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function z(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function A(e,t,n){return(A="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=M(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function V(e,t){return!t||"object"!==U(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}const H=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(a,e);var t,n,o,r,i=(o=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=M(o);if(r){var n=M(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return V(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e))._submitDelete=document.querySelector(".popup__save-button_delete"),t}return t=a,(n=[{key:"_openDeletePopup",value:function(){this.open()}},{key:"setSubmitAction",value:function(e){this._handleSubmitCallback=e}},{key:"setEventListeners",value:function(){var e=this;A(M(a.prototype),"setEventListeners",this).call(this),this._submitDelete.addEventListener("click",(function(){e._handleSubmitCallback()}))}}])&&z(t.prototype,n),a}(m);var J=new t({baseUrl:"https://around.nomoreparties.co/v1/group-8",headers:{authorization:"b69d5aa5-1ef4-42e6-80ff-c5b2987c86bb","Content-Type":"application/json"}}),G=function(e){var t=new d({data:e,handleCardClick:function(e,t){Q.open(e,t)},template:"#place-template",isMine:function(){return e.owner._id===W.getUserInfo().myId},myId:function(){return W.getUserInfo().myId},handleDeleteCard:function(){F._openDeletePopup(),F.setSubmitAction((function(){K(e,n)}))},handleCardLikes:function(){t.isLiked()?J.removeLike(e._id).then((function(e){t.updateLikes(e.likes),t.removeLike()})):J.addLike(e._id).then((function(e){t.updateLikes(e.likes),t.addLike()}))}}),n=t.generateCard();return n},F=new H(".popup__delete");F.setEventListeners();var K=function(e,t){J.deleteCard(e._id).then((function(){F.close(),t.remove()}))},Q=new T(".popup_image-large");Q.setEventListeners();var W=new D({nameSelector:".profile__name",jobSelector:".profile__title",avatarSelector:".profile__img"});J.getUserInfo().then((function(e){W.setUserInfo(e),W.changeAvatar(e)})).then((function(e){J.getInitialCards().then((function(e){X.renderItems(e.reverse())})).catch((function(e){console.log(e)}))}));var X=new R({items:[],renderer:function(e){var t=G(e);X.addItem(t)}},".places__list"),Y=new L(".popup_edit-profile",(function(e){J.editProfile(e).then((function(e){W.setUserInfo(e)})).catch((function(e){console.log(e)}))}));Y.setEventListeners();var Z=new L(".popup_edit-places",(function(e){J.addCard(e).then((function(e){var t=G(e);X.addItem(t),Z.isLoading(!0)})).catch((function(e){console.log(e)})),Z.isLoading(!1)}));Z.setEventListeners();var $=new L(".popup__edit-avatar",(function(e){J.editAvatar(e).then((function(e){console.log(e),W.changeAvatar(e)})).catch((function(e){console.log(e)}))}));f.addEventListener("click",(function(){$.open()})),$.setEventListeners(),s.addEventListener("click",(function(){var e=W.getUserInfo();console.log(e),i.value=e.name,a.value=e.job,Y.open()})),l.addEventListener("click",(function(){Y.close()})),u.addEventListener("click",(function(){Z.open(),ee(r)})),c.addEventListener("click",(function(){Z.close()})),o.addEventListener("click",(function(){Q.close()})),p.addEventListener("click",(function(){$.close()}));var ee=function(e){e.reset()};Array.from(document.querySelectorAll(n.formSelector)).forEach((function(e){new y(n,e).enableValidation(n)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80LU1BU1RFUi8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQtTUFTVEVSLy4vc3JjL3NjcmlwdHMvdXRpbHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC1NQVNURVIvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC1NQVNURVIvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC1NQVNURVIvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQtTUFTVEVSLy4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQtTUFTVEVSLy4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80LU1BU1RFUi8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80LU1BU1RFUi8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC1NQVNURVIvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwRGVsZXRlQ2FyZC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80LU1BU1RFUi8uL3NyYy9zY3JpcHRzL2luZGV4LmpzIl0sIm5hbWVzIjpbImJhc2VVcmwiLCJoZWFkZXJzIiwidGhpcyIsIl9iYXNlVXJsIiwiX2F1dGhvcml6ZSIsImF1dGhvcml6YXRpb24iLCJfY29udGVudFR5cGUiLCJmZXRjaCIsIm1ldGhvZCIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwidmFsdWVzIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJuYW1lIiwiYWJvdXQiLCJsaW5rIiwiYXZhdGFyIiwiZGF0YSIsImNhcmRJZCIsInNldHRpbmdzT2JqZWN0IiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvbiIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEJvcmRlckVycm9yIiwiaW1hZ2VzRXhpdCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInBsYWNlc0Zvcm0iLCJuZXdOYW1lIiwibmV3VGl0bGUiLCJhZGRQbGFjZXNFeGl0IiwiYWRkUGxhY2VCdXR0b24iLCJlZGl0QnV0dG9uIiwicHJvZmlsZUV4aXQiLCJlZGl0QXZhdGFyIiwiYXZhdGFyQ2xvc2UiLCJoYW5kbGVDYXJkQ2xpY2siLCJ0ZW1wbGF0ZSIsImlzTWluZSIsIm15SWQiLCJoYW5kbGVEZWxldGVDYXJkIiwiaGFuZGxlQ2FyZExpa2VzIiwiX3RlbXBsYXRlIiwiX2VsZW1lbnQiLCJfZ2V0VGVtcGxhdGUiLCJfZGF0YSIsIl9uYW1lIiwiX2xpbmsiLCJfYWx0IiwiX2xpa2VzIiwibGlrZXMiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2lzTWluZSIsIl9teUlkIiwiX2hhbmRsZURlbGV0ZUNhcmQiLCJfaGVhcnRCdXR0b24iLCJfaGVhcnRDb3VudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJwbGFjZUltYWdlIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl90cmFzaEJ1dHRvbiIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwiYWRkIiwicmVtb3ZlIiwibGlrZUNvdW50IiwidGV4dENvbnRlbnQiLCJsZW5ndGgiLCJmb3JFYWNoIiwibGlrZSIsIl9pZCIsInN0eWxlIiwiZGlzcGxheSIsInBsYWNlTmFtZSIsInNyYyIsImFsdCIsIl9yZW1vdmVEZWxldGVCdXR0b24iLCJfc2hvd0xpa2VzIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJmb3JtRWxlbWVudCIsInNldHRpbmdzT2JqIiwiX2lucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiX2lucHV0Qm9yZGVyRXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJpZCIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImlucHV0TGlzdCIsInNvbWUiLCJidXR0b25FbGVtZW50IiwiX2hhc0ludmFsaWRJbnB1dCIsImRpc2FibGVkIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXAiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwiaGFuZGxlQ2xvc2VPdmVybGF5Iiwia2V5IiwiY2xvc2UiLCJ0YXJnZXQiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic3VibWl0SGFuZGxlciIsIl9zdWJtaXRIYW5kbGVyIiwiX2Zvcm0iLCJfc2F2ZUJ1dHRvbiIsImlucHV0cyIsInZhbHVlIiwiaW5wdXQiLCJyZXNldCIsImlzTG9hZGluZyIsIl9nZXRJbnB1dFZhbHVlcyIsIlBvcHVwIiwiX3BvcHVwUGhvdG8iLCJfcG9wdXBUaXRsZSIsIm5ld0NhcHRpb24iLCJuZXdTcmMiLCJjYXJkRWxlbWVudFNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jYXJkRWxlbWVudCIsIml0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfam9iIiwiX2F2YXRhciIsImpvYiIsImJhY2tncm91bmRJbWFnZSIsIl9zdWJtaXREZWxldGUiLCJvcGVuIiwiaGFuZGxlU3VibWl0Q2FsbGJhY2siLCJfaGFuZGxlU3VibWl0Q2FsbGJhY2siLCJhcGkiLCJBcGkiLCJjcmVhdGVDYXJkIiwiY2FyZCIsIkNhcmQiLCJpbWFnZVBvcHVwIiwib3duZXIiLCJuZXdVc2VySW5mbyIsImdldFVzZXJJbmZvIiwiZGVsZXRlQ2FyZFBvcHVwIiwiX29wZW5EZWxldGVQb3B1cCIsInNldFN1Ym1pdEFjdGlvbiIsImNvbmZpcm1EZWxldGUiLCJwbGFjZUVsZW1lbnQiLCJpc0xpa2VkIiwicmVtb3ZlTGlrZSIsInVwZGF0ZUxpa2VzIiwiYWRkTGlrZSIsImdlbmVyYXRlQ2FyZCIsIlBvcHVwRGVsZXRlQ2FyZCIsInNldEV2ZW50TGlzdGVuZXJzIiwiZGVsZXRlQ2FyZCIsIlBvcHVwV2l0aEltYWdlIiwiVXNlckluZm8iLCJzZXRVc2VySW5mbyIsImNoYW5nZUF2YXRhciIsImdldEluaXRpYWxDYXJkcyIsIm5ld1NlY3Rpb24iLCJyZW5kZXJJdGVtcyIsInJldmVyc2UiLCJTZWN0aW9uIiwiYWRkSXRlbSIsImVkaXRQcm9maWxlUG9wdXAiLCJQb3B1cFdpdGhGb3JtIiwiZWRpdFByb2ZpbGUiLCJhZGRQbGFjZXNQb3B1cCIsImFkZENhcmQiLCJuZXdDYXJkIiwiZWRpdEF2YXRhclBvcHVwIiwiaW5mbyIsInJlc2V0Rm9ybSIsImZvcm0iLCJGb3JtVmFsaWRhdG9yIiwiZW5hYmxlVmFsaWRhdGlvbiJdLCJtYXBwaW5ncyI6InlMQTZMQSxRLFdBdExFLGNBQWdDLElBQW5CQSxFQUFtQixFQUFuQkEsUUFBU0MsRUFBVSxFQUFWQSxTLDRGQUFVLFNBQzlCQyxLQUFLQyxTQUFXSCxFQUNoQkUsS0FBS0UsV0FBYUgsRUFBUUksY0FDMUJILEtBQUtJLGFBQWVMLEVBQVEsZ0IsK0RBSTVCLE9BQU9NLE1BQU0sR0FBRCxPQUFJTCxL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QUFNLFNBQUNDLEdBQ05DLFFBQVFDLElBQUlGLFNBSWxCOEIsRUFBVzBCLGlCQUFpQixTQUFTLFdBQ25DbUksRUFBZ0J6QyxVQUVsQnlDLEVBQWdCbEIsb0JBSWhCN0ksRUFBVzRCLGlCQUFpQixTQUFTLFdBQ25DLElBQU1vSSxFQUFPaEMsRUFBWUMsY0FDekI1SixRQUFRQyxJQUFJMEwsR0FDWnBLLFFBQWdCb0ssRUFBS3JMLEtBQ3JCa0IsUUFBaUJtSyxFQUFLN0MsSUFJdEJzQyxFQUFpQm5DLFVBSW5CckgsRUFBWTJCLGlCQUFpQixTQUFTLFdBQ3BDNkgsRUFBaUJ0RSxXQUduQnBGLEVBQWU2QixpQkFBaUIsU0FBUyxXQUN2Q2dJLEVBQWV0QyxPQUNmMkMsR0FBVXRLLE1BSVpHLEVBQWM4QixpQkFBaUIsU0FBUyxXQUN0Q2dJLEVBQWV6RSxXQUlqQjNGLEVBQVdvQyxpQkFBaUIsU0FBUyxXQUNuQ2tHLEVBQVczQyxXQUdiaEYsRUFBWXlCLGlCQUFpQixTQUFTLFdBQ3BDbUksRUFBZ0I1RSxXQUlsQixJQUFNOEUsR0FBWSxTQUFDQyxHQUNqQkEsRUFBS3JFLFNBVVl2QixNQUFNQyxLQUFLOUUsU0FBUytFLGlCQUFpQnZGLEVBQWVDLGVBQzVEbUQsU0FBUSxTQUFDWSxHQUNNLElBQUlrSCxFQUFjbEwsRUFBZ0JnRSxHQUMxQ21ILGlCQUFpQm5MLE8iLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxyXG5cclxuLyoqXHJcbiAqIHdvcmtzIHdpdGggdGhlIEFQSVxyXG4gKiBBbGwgcmVxdWVzdHMgYXJlIG1ldGhvZHMgb2YgdGhpcyBDbGFzc1xyXG4gKi9cclxuY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7YmFzZVVybCwgaGVhZGVyc30pIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5fYXV0aG9yaXplID0gaGVhZGVycy5hdXRob3JpemF0aW9uO1xyXG4gICAgdGhpcy5fY29udGVudFR5cGUgPSBoZWFkZXJzW1wiQ29udGVudC1UeXBlXCJdO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRob3JpemVcclxuICAgICAgICBcclxuICAgICAgfVxyXG4gICAgfSlcclxuICAgICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gaWYgc2VydmVyIHJldHVybnMgYW4gZXJyb3IsIHJlamVjdCB0aGUgcHJvbWlzZVxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgfSlcclxuICAgICAgLy8gaWYgdGhlcmUgaXMgYW4gZXJyb3IsIGxvZyBpdFxyXG4gICAgICAuY2F0Y2goZXJyID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIEdFVHMgaW5mb3JtYXRpb24gZm9yIHRoZSB1c2VyIHByb2ZpbGVcclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aG9yaXplXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBpZihyZXMub2spe1xyXG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIG1vZGlmaWVkIHRoZSBwcm9maWxlIHRleHQgY29udGVudFxyXG4gIGVkaXRQcm9maWxlKHZhbHVlcykge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhvcml6ZSxcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiB0aGlzLl9jb250ZW50VHlwZVxyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogdmFsdWVzLm5hbWUsXHJcbiAgICAgICAgYWJvdXQ6IHZhbHVlcy5hYm91dFxyXG4gICAgICB9KVxyXG4gICAgfSlcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYocmVzLm9rKXtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgIH0pOyAgXHJcbiAgfVxyXG5cclxuICBlZGl0QXZhdGFyKHtsaW5rfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRob3JpemUsXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogdGhpcy5fY29udGVudFR5cGVcclxuICAgICAgfSxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcjogbGlua1xyXG4gICAgICB9KVxyXG4gICAgfSlcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYocmVzLm9rKXtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgIH0pOyAgXHJcbiAgfVxyXG5cclxuXHJcbiAgYWRkQ2FyZChkYXRhKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRob3JpemUsXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogdGhpcy5fY29udGVudFR5cGVcclxuICAgICAgfSxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IGRhdGEubmFtZSxcclxuICAgICAgICBsaW5rOiBkYXRhLmxpbmtcclxuICAgICAgfSlcclxuICAgIH0pXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmKHJlcy5vayl7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZExpa2UoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRob3JpemVcclxuICAgICAgICBcclxuICAgICAgfVxyXG4gICAgfSlcclxuICAgICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gaWYgc2VydmVyIHJldHVybnMgYW4gZXJyb3IsIHJlamVjdCB0aGUgcHJvbWlzZVxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgfSlcclxuICAgICAgLy8gaWYgdGhlcmUgaXMgYW4gZXJyb3IsIGxvZyBpdFxyXG4gICAgICAuY2F0Y2goZXJyID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIHJlbW92ZUxpa2UoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRob3JpemVcclxuICAgICAgICBcclxuICAgICAgfVxyXG4gICAgfSlcclxuICAgICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gaWYgc2VydmVyIHJldHVybnMgYW4gZXJyb3IsIHJlamVjdCB0aGUgcHJvbWlzZVxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgfSlcclxuICAgICAgLy8gaWYgdGhlcmUgaXMgYW4gZXJyb3IsIGxvZyBpdFxyXG4gICAgICAuY2F0Y2goZXJyID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6ICdERUxFVEUnLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aG9yaXplLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IHRoaXMuX2NvbnRlbnRUeXBlXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgLy8gcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgcmV0dXJuIHJlcztcclxuICAgICAgfVxyXG4gICAgICAvLyBpZiBzZXJ2ZXIgcmV0dXJucyBhbiBlcnJvciwgcmVqZWN0IHRoZSBwcm9taXNlXHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pXHJcbiAgICAvLyBpZiB0aGVyZSBpcyBhbiBlcnJvciwgbG9nIGl0XHJcbiAgICAuY2F0Y2goZXJyID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgIH0pO1xyXG4gIH1cclxuICBcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQXBpOyIsIlxyXG5jb25zdCBzZXR0aW5nc09iamVjdCA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLmZvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b246IFwiLnBvcHVwX19zYXZlLWJ1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwicG9wdXBfX3NhdmUtYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcInBvcHVwX19pbnB1dC1lcnJvclwiLFxyXG4gIGlucHV0Qm9yZGVyRXJyb3I6IFwicG9wdXBfX2lucHV0LWVycm9yX2NvbG9yXCJcclxufTtcclxuXHJcbmNvbnN0IGltYWdlc0V4aXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Nsb3NlLWJ1dHRvbl9pbWFnZXMnKTtcclxuY29uc3QgcGxhY2VzRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybS1wbGFjZXMnKTtcclxuY29uc3QgcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXAnKTsgLypwb3B1cCBoYXMgZGlzcGxheTogbm9uZSovXHJcbmNvbnN0IG5ld05hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X3RleHRfbmFtZScpOyAvKm5hbWUgd3JpdHRlbiBpbiB0aGUgbmFtZSBpbnB1dCAqL1xyXG5jb25zdCBuZXdUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdGV4dF90aXRsZScpOyAvKnRpdGxlIHdyaXR0ZW4gaW4gdGhlIHRpdGxlIGlucHV0ICovXHJcbmNvbnN0IGFkZFBsYWNlc0V4aXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Nsb3NlLWJ1dHRvbl9wbGFjZXMnKTsgLy9jbG9zZSBidXR0b25cclxuY29uc3QgYWRkUGxhY2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWRkJyk7IC8vYWRkIGJ1dHRvblxyXG5cclxuXHJcbi8qcHJvZmlsZSBzZWN0aW9uKi9cclxuY29uc3QgZWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0Jyk7IC8vZWRpdCBwcm9maWxlIGJ1dHRvblxyXG5jb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19uYW1lJyk7IC8vcHJvZmlsZSBuYW1lXHJcbmNvbnN0IHByb2ZpbGVUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX190aXRsZScpOyAvL3Byb2ZpbGUgZGVzY3JpcHRpb25cclxuY29uc3QgcHJvZmlsZUV4aXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Nsb3NlLWJ1dHRvbl9wcm9maWxlJyk7IC8vY2xvc2UgYnV0dG9uXHJcblxyXG5jb25zdCBlZGl0QXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2ltZy1lZGl0Jyk7IC8vIHBlbmNpbCBpY29uIG9uIGhvdmVyIG9mIGF2YXRhclxyXG5jb25zdCBhdmF0YXJDbG9zZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fY2xvc2UtYnV0dG9uX2F2YXRhcicpO1xyXG5cclxuY29uc3QgaGVhcnRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxhY2VzX19oZWFydC1idXR0b24nKTtcclxuXHJcblxyXG5cclxuZXhwb3J0IHsgc2V0dGluZ3NPYmplY3QsIGltYWdlc0V4aXQsIHBsYWNlc0Zvcm0sIHBvcHVwLCBuZXdOYW1lLCBuZXdUaXRsZSwgYWRkUGxhY2VzRXhpdCwgYWRkUGxhY2VCdXR0b24sIGVkaXRCdXR0b24sIHByb2ZpbGVOYW1lLCBwcm9maWxlVGl0bGUsIHByb2ZpbGVFeGl0LCBlZGl0QXZhdGFyLCBhdmF0YXJDbG9zZSwgaGVhcnRCdXR0b24gfTsiLCJcclxuY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3Ioe2RhdGEsIGhhbmRsZUNhcmRDbGljaywgdGVtcGxhdGUsIGlzTWluZSwgbXlJZCwgaGFuZGxlRGVsZXRlQ2FyZCwgaGFuZGxlQ2FyZExpa2VzfSkge1xyXG4gICAgdGhpcy5fdGVtcGxhdGUgPSB0ZW1wbGF0ZTtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG5cclxuICAgIHRoaXMuX2RhdGEgPSBkYXRhO1xyXG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl9hbHQgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XHJcblxyXG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gICAgdGhpcy5faXNNaW5lID0gaXNNaW5lO1xyXG4gICAgdGhpcy5fbXlJZCA9IG15SWQ7XHJcblxyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCA9IGhhbmRsZURlbGV0ZUNhcmQ7XHJcbiAgICB0aGlzLmhhbmRsZUNhcmRMaWtlcyA9IGhhbmRsZUNhcmRMaWtlcztcclxuXHJcbiAgICB0aGlzLl9oZWFydEJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLnBsYWNlc19faGVhcnQtYnV0dG9uJyk7XHJcbiAgICB0aGlzLl9oZWFydENvdW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucGxhY2VzX19oZWFydC1jb3VudCcpO1xyXG5cclxuICAgIC8vcG9wdXAgZGVsZXRlIGVsZW1lbnRcclxuICAgIC8vIHRoaXMuX3N1Ym1pdERlbGV0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fc2F2ZS1idXR0b25fZGVsZXRlJyk7XHJcbiAgfVxyXG5cclxuICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICBjb25zdCBwbGFjZVRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl90ZW1wbGF0ZSkuY29udGVudDtcclxuICAgIC8vIGNsb25lIGNvbnRlbnQgb2YgcGxhY2UgY2FyZCB0ZW1wbGF0ZSB0YWdcclxuICAgIGNvbnN0IHBsYWNlRWxlbWVudCA9IHBsYWNlVGVtcGxhdGUuY2xvbmVOb2RlKHRydWUpO1xyXG5cclxuICAgIHJldHVybiBwbGFjZUVsZW1lbnQ7XHJcblxyXG4gIH1cclxuXHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuXHJcbiAgICAvLyB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uKCk7XHJcbiAgICAvLyB0aGlzLl9oYW5kbGVEZWxldGVCdXR0b24oKTtcclxuICAgIHRoaXMucGxhY2VJbWFnZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspO1xyXG4gICAgfSlcclxuICAgIFxyXG4gICAgdGhpcy5fdHJhc2hCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQoKTtcclxuICAgIH0pXHJcbiAgICBcclxuICAgIHRoaXMuX2hlYXJ0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAvLyBpZih0aGlzLl9saWtlcy5zb21lKHRoaXMuX215SWQpKXtcclxuICAgICAgLy8gICB0aGlzLl9oZWFydEJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCdwbGFjZXNfX2hlYXJ0LWJ1dHRvbl9hY3RpdmUnKTtcclxuICAgICAgLy8gfVxyXG4gICAgICB0aGlzLmhhbmRsZUNhcmRMaWtlcygpO1xyXG4gICAgfSlcclxuXHJcbiAgICAvLyBwb3B1cERlbGV0ZSBlbGVtZW50XHJcbiAgICAvLyB0aGlzLl9zdWJtaXREZWxldGUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIC8vICAgY29uc29sZS5sb2coJ2RlbGV0ZSBtZScpO1xyXG4gICAgLy8gICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkKCk7XHJcbiAgICAvLyB9KVxyXG5cclxuICB9XHJcbiAgaXNMaWtlZCgpIHtcclxuICAgIGlmKHRoaXMuX2hlYXJ0QnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygncGxhY2VzX19oZWFydC1idXR0b25fYWN0aXZlJykpe1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFkZExpa2UoKSB7XHJcbiAgICB0aGlzLl9oZWFydEJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdwbGFjZXNfX2hlYXJ0LWJ1dHRvbl9hY3RpdmUnKTtcclxuICB9XHJcblxyXG4gIHJlbW92ZUxpa2UoKXtcclxuICAgIHRoaXMuX2hlYXJ0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ3BsYWNlc19faGVhcnQtYnV0dG9uX2FjdGl2ZScpO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlTGlrZXMobGlrZUNvdW50KSB7XHJcbiAgICB0aGlzLl9oZWFydENvdW50LnRleHRDb250ZW50ID0gbGlrZUNvdW50Lmxlbmd0aDtcclxuICB9XHJcblxyXG4gIC8vIF9oYW5kbGVMaWtlQnV0dG9uKCkge1xyXG4gICAgXHJcbiAgLy8gICAvLyBjb25zdCBoZWFydEJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLnBsYWNlc19faGVhcnQtYnV0dG9uJyk7XHJcbiAgLy8gICAvLyBXaGVuIHRoZSBoZWFydCBidXR0b24gaXMgY2xpY2tlZCwgYSBuZXcgY2xhc3Mgd2l0aCBhIFwibGlrZWRcIiBoZWFydCwgYXBwZWFyc1xyXG4gIC8vICAgY29uc3QgbGlrZUJ1dHRvbiA9IHBsYWNlID0+IHtcclxuICAvLyAgICAgdGhpcy5faGVhcnRCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZSgncGxhY2VzX19oZWFydC1idXR0b25fYWN0aXZlJyk7XHJcbiAgLy8gICB9O1xyXG5cclxuICAvLyAgIC8vIHRvZ2dsZXMgbGlrZSBidXR0b24gd2hlbiBjbGlja2VkXHJcbiAgLy8gICB0aGlzLl9oZWFydEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGxpa2VCdXR0b24pO1xyXG4gIC8vIH1cclxuICBcclxuICBfc2hvd0xpa2VzKCkge1xyXG4gICAgdGhpcy5fbGlrZXMuZm9yRWFjaCgobGlrZSkgPT4ge1xyXG4gICAgICBpZihsaWtlLl9pZCA9PT0gdGhpcy5fbXlJZCgpKXtcclxuICAgICAgICB0aGlzLl9oZWFydEJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdwbGFjZXNfX2hlYXJ0LWJ1dHRvbl9hY3RpdmUnKTtcclxuICAgICAgfVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIF9yZW1vdmVEZWxldGVCdXR0b24oKSB7XHJcbiAgICAvLyBpbWFnZSBwb3B1cCBkZWxldGUgYnV0dG9uXHJcbiAgICBcclxuICAgICAgdGhpcy5fdHJhc2hCdXR0b24uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG5cclxuICB9XHJcblxyXG5cclxuICBnZW5lcmF0ZUNhcmQoKSB7XHJcbiAgICAvLyB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuXHJcbiAgICBjb25zdCBwbGFjZUltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucGxhY2VzX19pbWcnKTtcclxuICAgIGNvbnN0IHBsYWNlTmFtZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLnBsYWNlc19fbmFtZScpO1xyXG4gICAgdGhpcy5fdHJhc2hCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGFjZXNfX2RlbGV0ZS1idXR0b24nKTtcclxuICAgIFxyXG4gICAgdGhpcy5wbGFjZUltYWdlID0gcGxhY2VJbWFnZTtcclxuICAgIHRoaXMucGxhY2VOYW1lID0gcGxhY2VOYW1lO1xyXG4gICAgXHJcbiAgICB0aGlzLnBsYWNlSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMucGxhY2VOYW1lLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMucGxhY2VJbWFnZS5hbHQgPSB0aGlzLnBsYWNlTmFtZS50ZXh0Q29udGVudDtcclxuXHJcbiAgICBpZighdGhpcy5faXNNaW5lKCkpIHtcclxuICAgICAgdGhpcy5fcmVtb3ZlRGVsZXRlQnV0dG9uKCk7XHJcbiAgICB9IFxyXG4gICBcclxuICAgIHRoaXMuX3Nob3dMaWtlcygpO1xyXG5cclxuICAgIHRoaXMuX2hlYXJ0Q291bnQudGV4dENvbnRlbnQgPSB0aGlzLl9kYXRhLmxpa2VzLmxlbmd0aDtcclxuICAgIFxyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50LmZpcnN0RWxlbWVudENoaWxkO1xyXG5cclxuICB9XHJcbiAgICBcclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IENhcmQ7IiwiXHJcbmNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzT2JqZWN0LCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5zZXR0aW5nc09iaiA9IHNldHRpbmdzT2JqZWN0O1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzT2JqZWN0LmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSBzZXR0aW5nc09iamVjdC5zdWJtaXRCdXR0b247XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3NPYmplY3QuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzT2JqZWN0LmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2lucHV0Qm9yZGVyRXJyb3IgPSBzZXR0aW5nc09iamVjdC5pbnB1dEJvcmRlckVycm9yO1xyXG4gICAgdGhpcy5mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgLy8gZGlzcGxheXMgdGhlIGVycm9yIG1lc3NhZ2UgYnkgYWRkaW5nIHRoZSBpbnB1dCBlcnJvciBtZXNzYWdlIGNsYXNzXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLmZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0Qm9yZGVyRXJyb3IpO1xyXG4gICAgLy8gbWFrZSB0aGUgdmFsaWRhdGlvbiBtZXNzYWdlIHRoZSBlcnJvciBtZXNzYWdlXHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcblxyXG4gIH07XHJcblxyXG4gIC8vIGhpZGVzIHRoZSBlcnJvciBtZXNzYWdlIGJ5IHJlbW92aW5nIHRoZSBpbnB1dCBlcnJvciBtZXNzYWdlIGNsYXNzXHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEJvcmRlckVycm9yKTtcclxuICAgIC8vcmVtb3ZlIGVycm9yIGNsYXNzTGlzdCB0byBpbnB1dCBlbGVtZW50XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gIH07XHJcblxyXG4gIC8vIGNoZWNrcyBpZiB0aGUgaW5wdXQgaXMgdmFsaWQsIHRoZW4gY2FsbHMgYSBmdW5jdGlvbiB0byBzaG93IG9yIGhpZGUgdGhlIGVycm9yIG1lc3NhZ2VcclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICAvLyBjaGVja3MgaW5wdXQgZWxlbWVudHMgdG8gc2VlIGlmIGFueSBvZiB0aGVtIGFyZSBmYWxzZVxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSB7XHJcbiAgICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcclxuICAgIH0pO1xyXG4gIH07XHJcblxyXG4gIC8vIGNoZWNrcyBoYXNJbnZhbGlkSW5wdXQoKSB0byBzZWUgaWYgYW55IGlucHV0cyBhcmUgbm90IHZhbGlkIHRvIGRldGVybWluZSBidXR0b24gc3RhdGVcclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50KSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcclxuICAgICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG5cclxuICAvKiBGaW5kcyBhbGwgdGhlIGlucHV0cyBpbiB0aGUgZm9ybSwgYW5kIHRoZSBzdWJtaXQgYnV0dG9uLCBhbmQgYmluZHMgYW4gZXZlbnQgbGlzdGVuZXIgdG8gZWFjaCBpbnB1dCB0aGF0IGNhbGxzIGNoZWNrSW5wdXRWYWxpZGl0eSBhbmQgdG9nZ2xlQnV0dG9uU3RhdGVcclxuICAqL1xyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20odGhpcy5mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpKTtcclxuICAgIC8vIHRoaXMuaW5wdXRMaXN0ID0gaW5wdXRMaXN0O1xyXG4gICAgY29uc3QgYnV0dG9uRWxlbWVudCA9IHRoaXMuZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b24pO1xyXG4gICAgLy9jaGVjayBpbnB1dHMgaWYgdmFsaWRhdGVkIGZpcnN0LCB0byBzZXQgc2F2ZSBidXR0b25cclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCk7XHJcblxyXG4gICAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigncmVzZXQnLCAoKSA9PiB7XHJcbiAgICAgIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCk7IC8vd2h5IGRvIEkgbmVlZCB0byBkbyB0aGlzPyBJIGFscmVhZHkgY2FsbCBoZXJlIC8vYWJvdmVcclxuICAgICAgfSlcclxuICAgIH0pXHJcblxyXG4gIH07XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3NPYmplY3QpIHtcclxuXHJcbiAgICB0aGlzLmZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgZnVuY3Rpb24gKGV2dCkge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfTtcclxuXHJcbn07XHJcblxyXG5cclxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjsiLCJcclxuLyoqXHJcbiAqIE9wZW4gYW5kIGNsb3NlIFBvcHVwcyBmcm9tOlxyXG4gKiBPdmVybGF5XHJcbiAqIENsb3NlIEJ1dHRvblxyXG4gKiBFc2NhcGUgQnV0dG9uXHJcbiAqL1xyXG5jbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSAgdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcclxuICAgIHRoaXMuaGFuZGxlQ2xvc2VPdmVybGF5ID0gdGhpcy5oYW5kbGVDbG9zZU92ZXJsYXkuYmluZCh0aGlzKTtcclxuICB9XHJcblxyXG4gIC8vIGNsb3NlcyBwb3B1cCBieSBwcmVzc2luZyBFc2Mga2V5XHJcbiAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xyXG4gICAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH07XHJcbiAgICAgIH0gXHJcbiAgXHJcbiAgaGFuZGxlQ2xvc2VPdmVybGF5KGV2dCkge1xyXG4gICAgaWYoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHVwX29wZW4nKSkge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBvcGVucyBwb3B1cFxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKCdwb3B1cF9vcGVuJyk7XHJcbiAgICAvLyBhZGRzIGxpc3RlbmVyIGZvciBFU0MgYnV0dG9uXHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcblxyXG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmhhbmRsZUNsb3NlT3ZlcmxheSk7XHJcbiAgfVxyXG5cclxuICAvLyBjbG9zZXMgcG9wdXBcclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuXCIpO1xyXG4gICAgLy8gcmVtb3ZlcyBsaXN0ZW5lciBmb3IgRVNDIGJ1dHRvblxyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG5cclxuICAgIHRoaXMuX3BvcHVwLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oYW5kbGVDbG9zZU92ZXJsYXkpOyBcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgY29uc3QgY2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Nsb3NlLWJ1dHRvbicpO1xyXG4gICAgY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBvcHVwOyIsIlxyXG5pbXBvcnQgUG9wdXAgZnJvbSAnLi9Qb3B1cC5qcyc7XHJcbmNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvciwgc3VibWl0SGFuZGxlcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9zdWJtaXRIYW5kbGVyID0gc3VibWl0SGFuZGxlcjsgXHJcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLmZvcm0nKTtcclxuICAgIHRoaXMuX3NhdmVCdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX3NhdmUtYnV0dG9uJyk7XHJcbiAgfVxyXG5cclxuICAvLyBjb2xsZWN0cyBkYXRhIGZyb20gYWxsIHRoZSBpbnB1dCBmaWVsZHNcclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBpbnB1dHMgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoJy5wb3B1cF9faW5wdXQnKTtcclxuICAgIGNvbnN0IHZhbHVlID0ge307XHJcblxyXG4gICAgaW5wdXRzLmZvckVhY2goaW5wdXQgPT4ge1xyXG4gICAgICB2YWx1ZVtpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSlcclxuXHJcbiAgICByZXR1cm4gdmFsdWU7XHJcblxyXG4gIH1cclxuXHJcbiAgLy8gcmVzZXRzIGZvcm0gb24gY2xvc2VcclxuICBjbG9zZSgpIHtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XHJcbiAgfVxyXG5cclxuICBpc0xvYWRpbmcoc3RhdHVzKSB7XHJcbiAgICBpZihzdGF0dXMpe1xyXG4gICAgICB0aGlzLl9zYXZlQnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcclxuICAgICAgY29uc29sZS5sb2codGhpcy5fc2F2ZUJ1dHRvbi50ZXh0Q29udGVudCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zYXZlQnV0dG9uLnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgICAgY29uc29sZS5sb2codGhpcy5fc2F2ZUJ1dHRvbi50ZXh0Q29udGVudCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZ0KSA9PiB7XHJcbiAgICAgIHRoaXMuaXNMb2FkaW5nKHRydWUpO1xyXG4gICAgICBjb25zb2xlLmxvZygnbG9hZGluZycpO1xyXG4gICAgICBjb25zdCB2YWx1ZXMgPSB0aGlzLl9nZXRJbnB1dFZhbHVlcygpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRIYW5kbGVyKHZhbHVlcyk7XHJcblxyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTsgLy9zdG9wcyBicm93c2VyIGZyb20gc3VibWl0dGluZyB0aGUgZm9ybSBpbiB0aGUgZGVmYXVsdCB3YXkgKHJlZnJlc2hlcyB3aGVuZXZlciB5b3Ugc3VibWl0KVxyXG4gICAgICBcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB0aGlzLmlzTG9hZGluZyhmYWxzZSk7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdsb2FkZWQnKTtcclxuICAgIH0pXHJcblxyXG5cclxuICAgXHJcbiAgfVxyXG5cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aEZvcm07IiwiaW1wb3J0IFBvcHVwIGZyb20gJy4vUG9wdXAuanMnO1xyXG5cclxuXHJcbi8qKlxyXG4gKiBPcGVucyBhIHBvcHVwIG9mIHRoZSBzZWxlY3RlZCBDYXJkIEltYWdlXHJcbiAqIGluIE9wZW4oKSwgdXNlcyB0aGUgc3JjIGFuZCBjYXB0aW9uIGFyZ3VtZW50cyB0byBwb3B1bGF0ZSBDYXJkIEltYWdlXHJcbiAqL1xyXG5jbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3BvcHVwUGhvdG8gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ltYWdlJyk7XHJcbiAgICB0aGlzLl9wb3B1cFRpdGxlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbWFnZS10aXRsZScpO1xyXG4gIH1cclxuXHJcbiAgb3BlbihuZXdDYXB0aW9uLCBuZXdTcmMpIHtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICAgIFxyXG4gICAgdGhpcy5fcG9wdXBQaG90by5zcmMgPSBuZXdTcmM7XHJcbiAgICB0aGlzLl9wb3B1cFRpdGxlLnRleHRDb250ZW50ID0gbmV3Q2FwdGlvbjtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aEltYWdlO1xyXG4iLCJcclxuXHJcbi8qKlxyXG4gKiBSZW5kZXJzIGEgbGlzdCBvZiBlbGVtZW50cyBvbiBhIHBhZ2VcclxuICogUmVjZWl2ZXMgbWFya3VwIHRocm91Z2ggYSBjYWxsYmFjayBmdW5jdGlvblxyXG4gKiBpbnNlcnRzIHRoZSBtYXJrdXAgaW4gdGhlIGNvbnRhaW5lclxyXG4gKi9cclxuY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3Ioe2l0ZW1zLCByZW5kZXJlcn0sIGNhcmRFbGVtZW50U2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7IC8vYXJyYXkgb2YgZGF0YSB0byBhZGQgb24gYSBwYWdlXHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyOyAvLyBjcmVhdGVzIGFuZCByZW5kZXJzIGRhdGEgb24gYSBwYWdlXHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY2FyZEVsZW1lbnRTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICAvLyByZW5kZXJzIGFsbCB0aGUgZWxlbWVudHMgb24gdGhlIHBhZ2VcclxuICByZW5kZXJJdGVtcyhpdGVtcykge1xyXG4gICAgLy8gdGhpcy5faXRlbXMuZm9yRWFjaChpdGVtID0+IHRoaXMucmVuZGVyZXIoaXRlbSkpOyBcclxuICAgIGl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pOyBcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gdGFrZXMgYSBET00gZWxlbWVudCBhbmQgYWRkcyB0byBhIGNvbnRhaW5lclxyXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFNlY3Rpb247IiwiXHJcblxyXG4vLyByZW5kZXJzIGluZm9ybWF0aW9uIGFib3V0IHRoZSBVc2VyIG9uIHRoZSBwYWdlXHJcbmNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7bmFtZVNlbGVjdG9yLCBqb2JTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3J9KSB7XHJcbiAgICB0aGlzLl9uYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fam9iID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9hdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIC8vIHJldHVybnMgYW4gb2JqZWN0IHdpdGggaW5mb3JtYXRpb24gdGhhdCBpcyBjdXJyZW50bHkgZGlzcGxheWVkXHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgY29uc3QgbmFtZSA9IHRoaXMuX25hbWUudGV4dENvbnRlbnQ7XHJcbiAgICBjb25zdCBqb2IgPSB0aGlzLl9qb2IudGV4dENvbnRlbnQ7XHJcbiAgICBjb25zdCBnZXRJbmZvID0ge25hbWUsIGpvYiwgbXlJZDogdGhpcy5teUlkfTtcclxuICAgIHJldHVybiBnZXRJbmZvO1xyXG4gIH1cclxuXHJcbiAgLy8gdGFrZXMgdXNlciBpbmZvIGFuZCBhZGRzIGl0IHRvIHRoZSBwYWdlXHJcbiAgc2V0VXNlckluZm8oZGF0YSkge1xyXG4gICAgdGhpcy5fbmFtZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX2pvYi50ZXh0Q29udGVudCA9IGRhdGEuYWJvdXQ7XHJcbiAgICB0aGlzLm15SWQgPSBkYXRhLl9pZDtcclxuICAgIFxyXG4gIH1cclxuXHJcbiAgY2hhbmdlQXZhdGFyKGRhdGEpIHtcclxuICAgIHRoaXMuX2F2YXRhci5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgdXJsKCR7ZGF0YS5hdmF0YXJ9KWA7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBVc2VySW5mbzsiLCJcclxuaW1wb3J0IHsgcG9wdXAgfSBmcm9tICcuLi91dGlscy5qcyc7XHJcbmltcG9ydCBQb3B1cCBmcm9tICcuL1BvcHVwLmpzJztcclxuY2xhc3MgUG9wdXBEZWxldGVDYXJkIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fc3VibWl0RGVsZXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19zYXZlLWJ1dHRvbl9kZWxldGUnKTtcclxuICB9XHJcblxyXG4gIF9vcGVuRGVsZXRlUG9wdXAoKSB7XHJcbiAgICB0aGlzLm9wZW4oKTtcclxuICB9XHJcblxyXG4gIHNldFN1Ym1pdEFjdGlvbihoYW5kbGVTdWJtaXRDYWxsYmFjaykge1xyXG4gICAgdGhpcy5faGFuZGxlU3VibWl0Q2FsbGJhY2sgPSBoYW5kbGVTdWJtaXRDYWxsYmFjaztcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG5cclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgdGhpcy5fc3VibWl0RGVsZXRlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlU3VibWl0Q2FsbGJhY2soKTtcclxuICAgICAgfSlcclxuICAgIFxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXBEZWxldGVDYXJkOyIsIlxyXG5pbXBvcnQgQXBpIGZyb20gXCIuL2NvbXBvbmVudHMvQXBpLmpzXCI7XHJcbmltcG9ydCBcIi4uL3BhZ2UvaW5kZXguY3NzXCI7XHJcbmltcG9ydCBcclxuICB7IHNldHRpbmdzT2JqZWN0LCBpbWFnZXNFeGl0LCBwbGFjZXNGb3JtLCBwb3B1cCwgbmV3TmFtZSwgbmV3VGl0bGUsIGFkZFBsYWNlc0V4aXQsIGFkZFBsYWNlQnV0dG9uLCBlZGl0QnV0dG9uLCBwcm9maWxlTmFtZSwgcHJvZmlsZVRpdGxlLCBwcm9maWxlRXhpdCwgZWRpdEF2YXRhciwgYXZhdGFyQ2xvc2UsIGhlYXJ0QnV0dG9uIH1cclxuZnJvbSBcIi4vdXRpbHMuanNcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgUG9wdXAgZnJvbSAnLi9jb21wb25lbnRzL1BvcHVwLmpzJzsgXHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gJy4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzJztcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBQb3B1cERlbGV0ZUNhcmQgZnJvbSBcIi4vY29tcG9uZW50cy9Qb3B1cERlbGV0ZUNhcmQuanNcIjtcclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC04XCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCJiNjlkNWFhNS0xZWY0LTQyZTYtODBmZi1jNWIyOTg3Yzg2YmJcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgfVxyXG59KTtcclxuXHJcbi8qKiBcclxuICogY3JlYXRlIGEgbmV3IGluc3RhbmNlIG9mIENhcmRcclxuICogY2FsbCBpbWFnZVBvcHVwIG9uIGNsaWNrLCB3aGljaCBvcGVucyBhbmQgcG9wdXBsYXRlcyB0aGUgcG9wdXAgSW1hZ2VcclxuICogdGVtcGxhdGU6IGNsb25lcyB0aGUgdGVtcGxhdGVcclxuICogZ2VuZXJhdGVzIGEgY2FyZCBmcm9tIHRoZSB0ZW1wbGF0ZVxyXG4gKiByZXR1cm5zIG5ldyBDYXJkIGVsZW1lbnRcclxuKi9cclxuY29uc3QgY3JlYXRlQ2FyZCA9IChpdGVtKSA9PiB7XHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKHtcclxuICAgIGRhdGE6IGl0ZW0sIFxyXG4gICAgaGFuZGxlQ2FyZENsaWNrOiAobmFtZSwgbGluaykgPT4ge1xyXG4gICAgICBpbWFnZVBvcHVwLm9wZW4obmFtZSwgbGluaylcclxuICAgIH0sXHJcbiAgICB0ZW1wbGF0ZTogXCIjcGxhY2UtdGVtcGxhdGVcIixcclxuICAgIGlzTWluZTogKCkgPT4ge1xyXG4gICAgICByZXR1cm4gaXRlbS5vd25lci5faWQgPT09IG5ld1VzZXJJbmZvLmdldFVzZXJJbmZvKCkubXlJZDtcclxuICAgIH0sXHJcbiAgICBteUlkOiAoKSA9PiB7XHJcbiAgICAgIHJldHVybiBuZXdVc2VySW5mby5nZXRVc2VySW5mbygpLm15SWQ7XHJcbiAgICB9LFxyXG4gICAgaGFuZGxlRGVsZXRlQ2FyZDogKCkgPT4ge1xyXG4gICAgICBkZWxldGVDYXJkUG9wdXAuX29wZW5EZWxldGVQb3B1cCgpO1xyXG4gICAgICBkZWxldGVDYXJkUG9wdXAuc2V0U3VibWl0QWN0aW9uKCgpID0+IHtcclxuICAgICAgICBjb25maXJtRGVsZXRlKGl0ZW0sIHBsYWNlRWxlbWVudCk7XHJcbiAgICAgIH0pO1xyXG4gICAgICBcclxuICAgIH0sXHJcbiAgICBoYW5kbGVDYXJkTGlrZXM6ICgpID0+IHtcclxuICAgICAgaWYoIWNhcmQuaXNMaWtlZCgpKXtcclxuICAgICAgICBhcGkuYWRkTGlrZShpdGVtLl9pZClcclxuICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgLy8gY2FyZC5faGVhcnRDb3VudC50ZXh0Q29udGVudCsrO1xyXG4gICAgICAgICAgICBjYXJkLnVwZGF0ZUxpa2VzKHJlcy5saWtlcyk7XHJcbiAgICAgICAgICAgIGNhcmQuYWRkTGlrZSgpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBhcGkucmVtb3ZlTGlrZShpdGVtLl9pZClcclxuICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgLy8gY2FyZC5faGVhcnRDb3VudC50ZXh0Q29udGVudC0tO1xyXG4gICAgICAgICAgICBjYXJkLnVwZGF0ZUxpa2VzKHJlcy5saWtlcyk7XHJcbiAgICAgICAgICAgIGNhcmQucmVtb3ZlTGlrZSgpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICBjb25zdCBwbGFjZUVsZW1lbnQgPSBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xyXG4gIHJldHVybiBwbGFjZUVsZW1lbnQ7XHJcbn1cclxuXHJcbiBjb25zdCBkZWxldGVDYXJkUG9wdXAgPSBuZXcgUG9wdXBEZWxldGVDYXJkKCcucG9wdXBfX2RlbGV0ZScpXHJcblxyXG4vLyAgY29uc3QgZGVsZXRlQ2FyZFBvcHVwID0gbmV3IFBvcHVwRGVsZXRlQ2FyZCgnLnBvcHVwX19kZWxldGUnLCAoaXRlbSkgPT4ge1xyXG4vLyAgIHNldFN1Ym1pdEFjdGlvbihjb25maXJtRGVsZXRlKGl0ZW0pKTtcclxuLy8gfSk7XHJcblxyXG4gIGRlbGV0ZUNhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICBjb25zdCBjb25maXJtRGVsZXRlID0gKGl0ZW0sIHBsYWNlRWxlbWVudCkgPT4ge1xyXG4gICAgYXBpLmRlbGV0ZUNhcmQoaXRlbS5faWQpXHJcbiAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICBkZWxldGVDYXJkUG9wdXAuY2xvc2UoKTtcclxuICAgICAgICBwbGFjZUVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICAgIH0pXHJcbiAgfVxyXG5cclxuLyoqXHJcbiAqIGNyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgUG9wdXBXaXRoSW1hZ2VcclxuICogdGFrZXMgaW4gdGhlIGxhcmdlIGltYWdlIGNsYXNzIGluIHRoZSB0ZW1wbGF0ZVxyXG4gKi9cclxuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZSgnLnBvcHVwX2ltYWdlLWxhcmdlJyk7XHJcbmltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuLyoqXHJcbiAqIENyZWF0ZXMgYSBuZXcgaW5zdGFuY2Ugb2YgVXNlckluZm9cclxuICogVGFrZXMgaW4gdGhlIGNsYXNzZXMgb2YgdGhlIHByb2ZpbGUgc2VjdGlvbiB0aGF0IGRpc3BsYXkgXCJjb250ZW50XCJcclxuICovXHJcbmNvbnN0IG5ld1VzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtuYW1lU2VsZWN0b3I6Jy5wcm9maWxlX19uYW1lJywgam9iU2VsZWN0b3I6ICcucHJvZmlsZV9fdGl0bGUnLCBhdmF0YXJTZWxlY3RvcjogJy5wcm9maWxlX19pbWcnfSk7XHJcblxyXG5cclxuYXBpLmdldFVzZXJJbmZvKClcclxuICAudGhlbigocmVzKSA9PiB7XHJcbiAgICBuZXdVc2VySW5mby5zZXRVc2VySW5mbyhyZXMpO1xyXG4gICAgbmV3VXNlckluZm8uY2hhbmdlQXZhdGFyKHJlcyk7XHJcbiAgICAvLyBuZXdVc2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIH0pXHJcbiAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgYXBpLmdldEluaXRpYWxDYXJkcygpXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBuZXdTZWN0aW9uLnJlbmRlckl0ZW1zKHJlcy5yZXZlcnNlKCkpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgIH0pXHJcbiAgICB9KVxyXG5cclxuXHJcbmNvbnN0IG5ld1NlY3Rpb24gPSBuZXcgU2VjdGlvbih7XHJcbiAgaXRlbXM6IFtdLFxyXG4gIHJlbmRlcmVyOihpdGVtKSA9PiB7XHJcbiAgICBjb25zdCBwbGFjZUVsZW1lbnQgPSBjcmVhdGVDYXJkKGl0ZW0pO1xyXG4gICAgbmV3U2VjdGlvbi5hZGRJdGVtKHBsYWNlRWxlbWVudCk7XHJcbiAgfVxyXG59LFxyXG4gIFwiLnBsYWNlc19fbGlzdFwiKTtcclxuXHJcblxyXG4gIFxyXG4vKipcclxuICogcmV0cmlldmVzIHVzZXIgZGF0YVxyXG4gKiBzZXRzIHRoZSBjdXJyZW50IHVzZXIgZGF0YVxyXG4gKi9cclxuLy8gYXBpLmdldFVzZXJJbmZvKClcclxuLy8gICAudGhlbigocmVzKSA9PiB7XHJcbi8vICAgICBuZXdVc2VySW5mby5zZXRVc2VySW5mbyhyZXMpO1xyXG4vLyAgIH0pXHJcblxyXG4vKipcclxuICogRkVUQ0hzIG5ldyB2YWx1ZXMgd2l0aCBlZGl0UHJvZmlsZSgpXHJcbiAqIGFkZHMgbmV3IHVzZXIgZGF0YSB0byBwcm9maWxlXHJcbiAqL1xyXG5jb25zdCBlZGl0UHJvZmlsZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oJy5wb3B1cF9lZGl0LXByb2ZpbGUnLCAodmFsdWVzKSA9PiB7XHJcbiAgYXBpLmVkaXRQcm9maWxlKHZhbHVlcylcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgbmV3VXNlckluZm8uc2V0VXNlckluZm8ocmVzKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgfSlcclxufSk7XHJcbmVkaXRQcm9maWxlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8qKlxyXG4gKiBnZXQgZGF0YSBmcm9tIGFkZFBsYWNlcyBwb3B1cFxyXG4gKiBQT1NUIGRhdGEgdG8gdGhlIHNlcnZlclxyXG4gKiBhZGQgZGF0YSB0byBwbGFjZXMgbGlzdCBvbiBET01cclxuICovXHJcbmNvbnN0IGFkZFBsYWNlc1BvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oJy5wb3B1cF9lZGl0LXBsYWNlcycsIChkYXRhKSA9PiB7XHJcbiAgYXBpLmFkZENhcmQoZGF0YSlcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgY29uc3QgbmV3Q2FyZCA9IGNyZWF0ZUNhcmQocmVzKTtcclxuICAgICAgbmV3U2VjdGlvbi5hZGRJdGVtKG5ld0NhcmQpO1xyXG4gICAgICBhZGRQbGFjZXNQb3B1cC5pc0xvYWRpbmcodHJ1ZSk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgIH0pXHJcbiAgICBhZGRQbGFjZXNQb3B1cC5pc0xvYWRpbmcoZmFsc2UpO1xyXG59KVxyXG5hZGRQbGFjZXNQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgZWRpdEF2YXRhclBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oJy5wb3B1cF9fZWRpdC1hdmF0YXInLCAobGluaykgPT4ge1xyXG4gIGFwaS5lZGl0QXZhdGFyKGxpbmspXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKHJlcyk7XHJcbiAgICAgIG5ld1VzZXJJbmZvLmNoYW5nZUF2YXRhcihyZXMpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICB9KVxyXG59KVxyXG5cclxuZWRpdEF2YXRhci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICBlZGl0QXZhdGFyUG9wdXAub3BlbigpO1xyXG59KVxyXG5lZGl0QXZhdGFyUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcblxyXG4vLyB3aGVuIGNsaWNrcywgdGhlIGVkaXQgcG9wdXAgYm94IG9wZW5zXHJcbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgY29uc3QgaW5mbyA9IG5ld1VzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgY29uc29sZS5sb2coaW5mbyk7XHJcbiAgbmV3TmFtZS52YWx1ZSA9IGluZm8ubmFtZTtcclxuICBuZXdUaXRsZS52YWx1ZSA9IGluZm8uam9iO1xyXG4gIC8vIG5ld05hbWUudmFsdWUgPSBwcm9maWxlTmFtZS50ZXh0Q29udGVudDtcclxuICAvLyBuZXdUaXRsZS52YWx1ZSA9IHByb2ZpbGVUaXRsZS50ZXh0Q29udGVudDtcclxuXHJcbiAgZWRpdFByb2ZpbGVQb3B1cC5vcGVuKCk7XHJcbiAgXHJcbn0pO1xyXG4vLyB3aGVuIGNsaWNrcywgdGhlIGVkaXQgcG9wdXAgYm94IGNsb3Nlc1xyXG5wcm9maWxlRXhpdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICBlZGl0UHJvZmlsZVBvcHVwLmNsb3NlKCk7XHJcbn0pO1xyXG4vLyB3aGVuIGNsaWNrcywgdGhlIHBvcHVwIGJveCBvcGVucyBcclxuYWRkUGxhY2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgYWRkUGxhY2VzUG9wdXAub3BlbigpO1xyXG4gIHJlc2V0Rm9ybShwbGFjZXNGb3JtKTtcclxuICBcclxufSk7XHJcbi8vIHdoZW4gY2xpY2tzLCB0aGUgYWRkIHBsYWNlcyBwb3B1cCBib3ggY2xvc2VzXHJcbmFkZFBsYWNlc0V4aXQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgYWRkUGxhY2VzUG9wdXAuY2xvc2UoKTtcclxufSk7XHJcblxyXG4vLyBvbiBjbGljayBvZiBjbG9zZSBidXR0b24sIHRoZSBwb3B1cCBpbWFnZSB3aWxsIGRpc2FwcGVhclxyXG5pbWFnZXNFeGl0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gIGltYWdlUG9wdXAuY2xvc2UoKTtcclxufSk7XHJcblxyXG5hdmF0YXJDbG9zZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICBlZGl0QXZhdGFyUG9wdXAuY2xvc2UoKTtcclxufSlcclxuXHJcbi8vIHJlc2V0IGZvcm0sIG1heSBkZWxldGUsIGNyZWF0ZWQgaW4gUG9wdXBXaXRoRm9ybSBjbGFzc1xyXG5jb25zdCByZXNldEZvcm0gPSAoZm9ybSkgPT4ge1xyXG4gIGZvcm0ucmVzZXQoKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIGNyZWF0ZXMgYW4gYXJyYXkgb2YgbmV3IGZvcm1zXHJcbiAqIGZvciBlYWNoIGZvcm0sIGFuIGluc3RhbmNlIG9mIEZvcm1WYWxpZGF0b3IgaXMgY3JlYXRlZFxyXG4gKiBjYWxscyBmdW5jdGlvbiB0byBiZWdpbiB2YWxpZGF0aW9uXHJcbiAqL1xyXG5jb25zdCByZW5kZXJGb3JtVmFsaWRhdGlvbiA9ICgpID0+IHtcclxuXHJcbiAgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2V0dGluZ3NPYmplY3QuZm9ybVNlbGVjdG9yKSk7XHJcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcclxuICAgIGNvbnN0IGZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5nc09iamVjdCwgZm9ybUVsZW1lbnQpO1xyXG4gICAgZm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzT2JqZWN0KTtcclxuICB9KTtcclxufTtcclxuXHJcbnJlbmRlckZvcm1WYWxpZGF0aW9uKCk7XHJcblxyXG4iXSwic291cmNlUm9vdCI6IiJ9